# WinRM Pentesting

Target Machine : ```192.168.10.7```

Attacker Machine : ```192.168.10.8```

Before we start the attack, th Windows Remote Management should be enabled in ADDC.

Enable the PSRemoting : to recieve Powershell remote commands that are sent.

```Enable-PSRemoting -force```


## WinRM config :

The WinRM listens on port 5985 for http and 5986 for https.

```
winrm quiconfig -transport:https
Set-Item wsman:\localhost\client\truetedhosts *
Restart-Service WinRM
net localgroup "Remote Management Users" /add Administrator
```

We log in to another user account to test the connection :


And this was the required configuration for our WinRM service

in AD computers, we run the powershell as an Administrator and we run the following command :
```
Enable-PSRemoting -Force
```

To check the service :
```
Get-Service WinRM
```

In Windows Server :

```
Enter-PSSession <computername>
```
### Lateral Mouvement


in metasploit we determinse wich auth method this domain uses :
if we try brute force the creds, it wont work since we set a policy of ccount locked out after 5 failed attempt
